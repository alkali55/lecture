<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2차원 배열을 이용한 성적표</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script> -->
    <script>

        // 학번, 이름, 국, 영, 수,
        // 총점, 평균, 학점


        const STU_CNT = 5;
        let scores = new Array(5);
        
        
        for (i = 0; i < scores.length; i++){
            scores[i] = new Array(8);
            for (let j = 0; j < scores[i].length; j++){
                switch(j){
                    case 0:
                        scores[i][j] = "stuNum" + i;
                        break;
                    case 1:
                        scores[i][j] = "name" + i;
                        break;
                    case 2:
                    case 3:
                    case 4:
                        scores[i][j] = Math.ceil(Math.random() * 50 + 50);
                        break;
                    case 5:
                        scores[i][j] = scores[i][2] + scores[i][3] + scores[i][4];
                        break;
                    case 6:
                        scores[i][j] = (scores[i][5] / 3).toFixed(2);
                        break;
                    case 7:
                        scores[i][j] = calGrade(scores[i][6]);
                        break;
                }
            }
        }


        // 평균 내림차순 정렬

        desc();

        // 등수 찍기

        for (let ind in scores){
            scores[ind][8] = Number(ind) + 1;
            if (ind > 0 && scores[ind][5] == scores[ind - 1][5]){
                scores[ind][8] = scores[ind - 1][8];
            }
        }

        tableSetter();

        function order() {
            let order = "";
            let radios = document.getElementsByName("order");
            for (let radio of radios){
                if (radio.checked == true) {
                    order = radio.value;
                }
            }
            // console.log(order);

            if (order == "asc"){
                // 평균 오름차순 정렬
                asc();
            } else {
                // 평균 내림차순 정렬
                desc();
            }

            tableChanger(scores);
        }

        function desc() {
            for (let i = 0; i < scores.length - 1; i++){
                for (let j = i + 1; j < scores.length; j++){
                    if (scores[i][6] < scores[j][6]){
                        let tmp = scores[j];
                        scores[j] = scores[i];
                        scores[i] = tmp;
                    }
                    
                }
            }
        }

        function asc() {
            for (let i = 0; i < scores.length - 1; i++){
                for (let j = i + 1; j < scores.length; j++){
                    if (scores[i][6] > scores[j][6]){
                        let tmp = scores[j];
                        scores[j] = scores[i];
                        scores[i] = tmp;
                    }
                        
                }
            }
        }

        function tableSetter() {
            let table = "<table border = '1' class = 'table'>";
            table += "<tr><th>학번</th><th>이름</th><th>국어</th><th>영어</th><th>수학</th><th>총점</th><th>평균</th><th>학점</th><th>등수</th></tr>"
            for (let i = 0; i < scores.length; i++){
                table += "<tr>";
                for (let j = 0; j < scores[i].length; j++){
                    table += `<td id ="${i * scores[i].length + j}td">${scores[i][j]}</td>`;
                }
                table += "</tr>";
            }
            table += "</table>";
            document.write("<h2>성적표V4</h2>" + table);
        }

        function tableChanger(array) {
            for(let i = 0; i < array.length; i++){
                for(let j = 0; j < array[i].length; j++){
                    document.getElementById(`${i * array[i].length + j}td`).innerHTML = array[i][j];
                }
            }
        }

        function calGrade(avg) {
            if (avg >= 90 && avg <= 100) {
                return "A";
            } else if (avg >= 80 && avg < 90) {
                return "B";
            } else if (avg >= 70 && avg < 80) {
                return "C";
            } else if (avg >= 60 && avg < 70) {
                return "D";
            } else {
                return "F";
            }
        }
        
    </script>
    <style>
        body {
            margin: 15px;
        }
    </style>
</head>
<body>
    <div id="order">
        <input type = "radio" name = "order" id = "asc" value = "asc"> 평균 오름차순 정렬
        <input type = "radio" name = "order" id = "desc" value = "desc"> 평균 내림차순 정렬
        <button onclick="order()">정렬</button>
    </div>
    <!-- <div id="table">

    </div> -->
</body>
</html>