-- DML (DATA MANIPULATE LANGUAGE)
-- 1. INSERT INTO : 데이터 저장
CREATE TABLE EMP01 (
    EMPNO NUMBER(4),
    ENAME VARCHAR2(16),
    JOB VARCHAR2(12),
    SAL NUMBER(6)
);

INSERT INTO EMP01 VALUES(1000, '홍길동', '사장님', 10000);


ALTER TABLE EMP01
ADD HIREDATE DATE;

INSERT INTO EMP01 VALUES('1001', '이대호', '사원', 4000, SYSDATE);

INSERT INTO EMP01 (EMPNO, ENAME) VALUES(1002, '정근우');

INSERT INTO EMP01 VALUES(1003, '이택근', NULL, 3000, SYSDATE);

SELECT * FROM EMP01;

CREATE TABLE COPYEMP
AS SELECT * FROM EMPLOYEES
WHERE 1 = 0;

DESC COPYEMP;

-- 서브쿼리를 이용하여 한번에 여러 데이터를 추가
INSERT INTO COPYEMP (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, JOB_ID, HIRE_DATE,
SALARY, DEPARTMENT_ID)
SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, JOB_ID, HIRE_DATE,
SALARY, DEPARTMENT_ID FROM EMPLOYEES;

SELECT * FROM COPYEMP;

--2. UPDATE문 
UPDATE EMP01 SET SAL = 200000; -- 전체행에 대해서 수정!!!!

UPDATE EMP01 SET SAL = 10000
WHERE EMPNO = 1001; -- 사번이 1001번 사원의 월급을 수정

UPDATE EMP01 SET SAL = 5000
WHERE EMPNO = 1002;

UPDATE EMP01 SET SAL = 7000
WHERE EMPNO = 1003;

-- 1002번 사원의 월급을 1003번 사원의 월급과 동일하게 수정

SELECT SAL FROM EMP01 WHERE EMPNO = 1003; -- 7000
ROLLBACK;

UPDATE EMP01 SET SAL = (SELECT SAL FROM EMP01 WHERE EMPNO = 1003)
WHERE EMPNO = 1002;

SELECT * FROM EMP01;

-- 3. DELETE 문
DELETE FROM EMP01 WHERE EMPNO = 1002;

DELETE FROM EMP01; -- ROLLBACK 가능
ROLLBACK;


-- TRUNCATE와 DELETE 비교
TRUNCATE TABLE EMP01; -- ROLLBACK 불가!

INSERT INTO EMP01 VALUES('1001', '이대호', '사원', 4000, SYSDATE);
ROLLBACK;